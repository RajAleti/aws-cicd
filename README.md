# AWS CI/CD Sample Project

This repository demonstrates a simple Python application and supporting scripts for AWS CI/CD workflows using CodeBuild, CodeDeploy, and Docker.

## Project Structure

- `app.py`: Flask web application ("Hello, world!").
- `appspec.yml`: AWS CodeDeploy specification for deployment hooks.
- `scripts/`
  - `lambda.py`: AWS Lambda function to modify EBS volume type using boto3.
  - `start_container.sh`: Bash script to pull and run the Docker image for the app.
  - `stop_container.sh`: Bash script to stop the running container.
- `simple-python-app/`
  - `buildspec.yml`: AWS CodeBuild specification for building, testing, and pushing Docker images.
  - `Dockerfile`: Docker image definition for the Flask app.
  - `requirements.txt`: Python dependencies (Flask).

## Setup & Usage

### Prerequisites
- AWS account with CodeBuild and CodeDeploy configured
- Docker installed (for local testing)
- Python 3.8+ (for local development)

### Local Development
1. Install dependencies:
   ```sh
   pip install -r simple-python-app/requirements.txt
   ```
2. Run the Flask app:
   ```sh
   python app.py
   ```
   The app will be available at http://localhost:5000

### Docker
1. Build the Docker image:
   ```sh
   cd simple-python-app
   docker build -t simple-python-flask-app .
   ```
2. Run the container:
   ```sh
   docker run -d -p 5000:5000 simple-python-flask-app
   ```

### AWS CI/CD Pipeline
- **CodeBuild** uses `buildspec.yml` to install dependencies, run tests, build, and push the Docker image.
- **CodeDeploy** uses `appspec.yml` to run deployment hooks (`start_container.sh` and `stop_container.sh`).
- **Lambda Function** (`lambda.py`) can be used to automate EBS volume modifications.

## Deployment Scripts
- `scripts/start_container.sh`: Pulls and runs the Docker image from Docker Hub.
- `scripts/stop_container.sh`: Stops the running container.

## Lambda Function Example
- `lambda.py` expects an event with an EBS volume ARN or volume ID and modifies its type to `gp3` using boto3.

## License
MIT License

---
*Generated by reviewing all code and configuration files in this repository.*